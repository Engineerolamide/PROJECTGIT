{
	"name": "SQL script 1000000",
	"properties": {
		"content": {
			"query": "SELECT TOP 100\n    jsonContent\n/* --> place the keys that you see in JSON documents in the WITH clause:\n       , JSON_VALUE (jsonContent, '$.key1') AS header1\n       , JSON_VALUE (jsonContent, '$.key2') AS header2\n*/\nFROM\n    OPENROWSET(\n        BULK 'https://storagedatalakeengineer.dfs.core.windows.net/jsoncontainer/sales.json',\n        FORMAT = 'csv',\n        FIELDQUOTE = '0x0b',\n        FIELDTERMINATOR ='0x0b',\n        ROWTERMINATOR = '0x0b'\n    )\n    WITH (\n        jsonContent varchar(MAX)\n    ) AS [result]\n\n    SELECT \n    doc.value AS raw_json,\n    jsoncontent,\n    JSON_VALUE(jsoncontent, '$.orderID') AS orderID,\n    JSON_VALUE(jsoncontent, '$.orderDate') AS orderDate,\n    JSON_VALUE(jsoncontent, '$.orderSource') AS orderSource,\n    JSON_VALUE(jsoncontent, '$.customerDevice') AS customerDevice\n    JSON_VALUE(jsoncontent, '$.orderDetails') AS orderDetails,\n    JSON_VALUE(jsoncontent, '$.productID') AS productID,\n    JSON_VALUE(jsoncontent, '$.orderQuantity') AS orderQuantity,\n    JSON_VALUE(jsoncontent, '$.deliveryAddress') AS deliveryAddress,\nFROM OPENROWSET(\n    BULK 'https://storagedatalakeengineer.blob.core.windows.net/jsoncontainer/sales.json',\n    FORMAT = 'JSON'\n)\nWITH (\n    jsoncontent varchar(max)\n) AS rows [doc];\n\nSELECT\n    JSON_VALUE(BulkColumn, '$.orderID') AS orderID,\n    JSON_VALUE(BulkColumn, '$.orderDate') AS orderDate,\n    JSON_VALUE(BulkColumn, '$.orderSource') AS orderSource,\n    JSON_VALUE(BulkColumn, '$.customerDevice') AS customerDevice,\n    JSON_VALUE(BulkColumn, '$.orderQuantity') AS orderQuantity\nFROM OPENROWSET(\n    BULK 'https://storagedatalakeengineer.blob.core.windows.net/jsoncontainer/sales.json',\n    FORMAT = 'CSV',\nPARSER_VERSION = '2.0'\n) AS [result]\n\nSELECT JSON_VALUE(doc.value, '$.orderID') AS orderID\n    JSON_VALUE(doc.value, '$.orderDate') AS orderDate,\n    JSON_VALUE(doc.value, '$.orderSource') AS orderSource,\n    JSON_VALUE(doc.value, '$.customerDevice') AS customerDevice\n    JSON_VALUE(doc.value, '$.orderDetails') AS orderDetails,\n    JSON_VALUE(doc.value, '$.productID') AS productID,\n    JSON_VALUE(doc.value, '$.orderQuantity') AS orderQuantity,\n    JSON_VALUE(doc.value, '$.deliveryAddress') AS deliveryAddress,\nFROM OPENROWSET(\n    BULK 'https://storagedatalakeengineer.blob.core.windows.net/jsoncontainer/sales.json',\n    FORMAT = 'CSV'\n    )\n    WITH (\n    jsoncontent varchar(max)\n) AS rows (doc)\nSELECT * \nFROM sys.external_data_sources;\n\nSELECT\n    JSON_VALUE(BulkColumn, '$.orderID') AS orderID,\n    JSON_VALUE(BulkColumn, '$.orderDate') AS orderDate,\n    JSON_VALUE(BulkColumn, '$.orderSource') AS orderSource,\n    JSON_VALUE(BulkColumn, '$.customerDevice') AS customerDevice,\n    JSON_VALUE(BulkColumn, '$.orderQuantity') AS orderQuantity\nFROM OPENROWSET(\n    BULK 'https://storagedatalakeengineer.blob.core.windows.net/jsoncontainer/sales.json',\n    DATA_SOURCE = 'enterpriselake',\n    SINGLE_CLOB\n) AS [result]\n\nCREATE EXTERNAL FILE FORMAT JsonFormat\nWITH (\n    FORMAT_TYPE = DELIMITEDTEXT,\n    FORMAT_OPTIONS (\n        FIELD_TERMINATOR = '0x0',\n        STRING_DELIMITER = '\"',\n        ENCODING = 'UTF8'\n    )\n);\nSELECT TOP 100\n    JSON_VALUE(jsoncontent, '$.orderID') AS orderID,\n    JSON_VALUE(jsoncontent, '$.orderDate') AS orderDate,\n    JSON_VALUE(jsoncontent, '$.orderSource') AS orderSource,\n    JSON_VALUE(jsoncontent, '$.customerDevice') AS customerDevice,\n    details.productID,\n    details.orderQuantity\nFROM OPENROWSET(\n    BULK 'https://storagedatalakeengineer.blob.core.windows.net/jsoncontainer/sales.json',\n    FORMAT = 'JsonFormat'\n)\nWITH (\n    jsoncontent varchar(max)\n) AS [result]\nCROSS APPLY OPENJSON(jsoncontent, '$.orderDetails')\nWITH (\n    productID int '$.productID',\n    orderQuantity int '$.orderQuantity'\n) AS details;\n\nSELECT \n    JSON_VALUE(BulkColumn, '$.orderID') AS orderID,\n    JSON_VALUE(BulkColumn, '$.orderDate') AS orderDate,\n    JSON_VALUE(BulkColumn, '$.orderSource') AS orderSource,\n    JSON_VALUE(BulkColumn, '$.customerDevice') AS customerDevice,\n    JSON_VALUE(BulkColumn, '$.orderQuantity') AS orderQuantity\nFROM OPENROWSET(\n    BULK 'https://storagedatalakeengineer.blob.core.windows.net/jsoncontainer/sales.json',\n    DATA_SOURCE = 'OlamideLakeDataSource',\n    FORMAT = 'JSON',\n    FIELDTERMINATOR ='0x0b',\n    FIELDQUOTE = '0x0b',\n    ROWTERMINATOR = '0x0a'\n) AS [result]\n\nSELECT \n    JSON_VALUE(doc, '$.orderId') AS OrderID,\n    JSON_QUERY(doc, '$.orderDetails') AS OrderDetails\nFROM OPENROWSET(\n    BULK 'https://storagedatalakeengineer.blob.core.windows.net/jsoncontainer/sales.json',\n    FORMAT = 'CSV',\n    FIELDTERMINATOR = '0x0b',\n    FIELDQUOTE = '0x0b'\n) WITH (doc NVARCHAR(MAX)) AS rows;\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "Olamidemssqltips",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}